<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" version="29.4.0" pages="4">
  <diagram name="4.5 LEAP执行流水线" id="vX4hOh05j7iNc7IT5y-0">
    <mxGraphModel dx="1213" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="frame" parent="1" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;fillColor=none;strokeColor=#CCCCCC;" value="" vertex="1">
          <mxGeometry height="320" width="760" x="40" y="40" as="geometry" />
        </mxCell>
        <mxCell id="input" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" value="输入: 确定性序列 π&lt;sub&gt;h&lt;/sub&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;(来自第四章 CADO)&lt;/font&gt;" vertex="1">
          <mxGeometry height="60" width="130" x="60" y="150" as="geometry" />
        </mxCell>
        <mxCell id="stage1" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="① 域感知计划&lt;br&gt;(Domain-aware Plan)&lt;br&gt;&lt;i style=&quot;font-size:10px&quot;&gt;划分域段 / 弱独立检测&lt;/i&gt;" vertex="1">
          <mxGeometry height="60" width="140" x="230" y="150" as="geometry" />
        </mxCell>
        <mxCell id="workers_bg" parent="1" style="swimlane;horizontal=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;startSize=20;" value="③ 并行执行与验证&lt;br&gt;(Workers)" vertex="1">
          <mxGeometry height="240" width="160" x="410" y="60" as="geometry" />
        </mxCell>
        <mxCell id="w1" parent="workers_bg" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;" value="Worker 1" vertex="1">
          <mxGeometry height="30" width="120" x="20" y="40" as="geometry" />
        </mxCell>
        <mxCell id="w2" parent="workers_bg" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;" value="Worker 2" vertex="1">
          <mxGeometry height="30" width="120" x="20" y="90" as="geometry" />
        </mxCell>
        <mxCell id="w3" parent="workers_bg" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" value="..." vertex="1">
          <mxGeometry height="30" width="30" x="65" y="130" as="geometry" />
        </mxCell>
        <mxCell id="wn" parent="workers_bg" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;" value="Worker N" vertex="1">
          <mxGeometry height="30" width="120" x="20" y="170" as="geometry" />
        </mxCell>
        <mxCell id="mvstate" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#e1d5e7;strokeColor=#9673a6;" value="② MVState&lt;br&gt;(多版本状态)" vertex="1">
          <mxGeometry height="70" width="80" x="450" y="320" as="geometry" />
        </mxCell>
        <mxCell id="hotdelta" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" value="④ Hot-Delta 分片&lt;br&gt;&lt;i style=&quot;font-size:10px&quot;&gt;热点写冲突消除&lt;/i&gt;" vertex="1">
          <mxGeometry height="50" width="150" x="610" y="70" as="geometry" />
        </mxCell>
        <mxCell id="backpressure" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="⑤ 自适应背压&lt;br&gt;&lt;i style=&quot;font-size:10px&quot;&gt;动态调整窗口 W&lt;/i&gt;" vertex="1">
          <mxGeometry height="50" width="150" x="610" y="150" as="geometry" />
        </mxCell>
        <mxCell id="output" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" value="输出: StateRoot&lt;sub&gt;h&lt;/sub&gt;" vertex="1">
          <mxGeometry height="50" width="150" x="610" y="230" as="geometry" />
        </mxCell>
        <mxCell id="e1" edge="1" parent="1" source="input" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="stage1" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" edge="1" parent="1" source="stage1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="workers_bg" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="workers_bg" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;" target="mvstate" value="读写">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e4" edge="1" parent="1" source="workers_bg" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="hotdelta" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="590" y="180" />
              <mxPoint x="590" y="95" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="workers_bg" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="backpressure" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" edge="1" parent="1" source="backpressure" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="output" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e7" edge="1" parent="1" source="hotdelta" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" target="backpressure" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="71rPddaPsSAGoQB6BubI" name="4.8 热点账户增量分片">
    <mxGraphModel dx="1213" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="base_bal" parent="1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f5f5f5;strokeColor=#666666;" value="Base Balance&lt;br&gt;(基础余额)" vertex="1">
          <mxGeometry height="80" width="80" x="80" y="120" as="geometry" />
        </mxCell>
        <mxCell id="tx_group" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="大量并发写入交易&lt;br&gt;(Tx1, Tx2, ... TxN)" vertex="1">
          <mxGeometry height="40" width="280" x="240" y="40" as="geometry" />
        </mxCell>
        <mxCell id="hash_func" parent="1" style="rhombus;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Hash(Tx) % P" vertex="1">
          <mxGeometry height="60" width="120" x="320" y="110" as="geometry" />
        </mxCell>
        <mxCell id="slots_container" parent="1" style="swimlane;whiteSpace=wrap;html=1;startSize=20;fillColor=#f8cecc;strokeColor=#b85450;" value="增量槽 (Delta Slots)" vertex="1">
          <mxGeometry height="80" width="280" x="240" y="200" as="geometry" />
        </mxCell>
        <mxCell id="s0" parent="slots_container" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;" value="Slot 0" vertex="1">
          <mxGeometry height="30" width="50" x="20" y="30" as="geometry" />
        </mxCell>
        <mxCell id="s1" parent="slots_container" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;" value="Slot 1" vertex="1">
          <mxGeometry height="30" width="50" x="90" y="30" as="geometry" />
        </mxCell>
        <mxCell id="dots" parent="slots_container" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="..." vertex="1">
          <mxGeometry height="20" width="20" x="150" y="35" as="geometry" />
        </mxCell>
        <mxCell id="sP" parent="slots_container" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;" value="Slot P" vertex="1">
          <mxGeometry height="30" width="50" x="190" y="30" as="geometry" />
        </mxCell>
        <mxCell id="aggregation" parent="1" style="triangle;whiteSpace=wrap;html=1;direction=north;fillColor=#d5e8d4;strokeColor=#82b366;" value="聚合 (Sum)" vertex="1">
          <mxGeometry height="80" width="60" x="600" y="120" as="geometry" />
        </mxCell>
        <mxCell id="final_val" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1" value="最终余额" vertex="1">
          <mxGeometry height="40" width="100" x="680" y="140" as="geometry" />
        </mxCell>
        <mxCell id="e_tx_hash" edge="1" parent="1" source="tx_group" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="hash_func" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_hash_slots" edge="1" parent="1" source="hash_func" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="slots_container" value="分散写入">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_base_agg" edge="1" parent="1" source="base_bal" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="aggregation" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="120" y="90" />
              <mxPoint x="630" y="90" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e_slots_agg" edge="1" parent="1" source="slots_container" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" target="aggregation" value="读取时合并">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="630" y="240" />
              <mxPoint x="630" y="160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e_agg_final" edge="1" parent="1" source="aggregation" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="final_val" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="fpSuaEC6j-ADtBtl1JZK" name="5.4 MVState结构">
    <mxGraphModel dx="1213" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_54" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" value="图 5.4 多版本状态版本链结构 (MVState)" vertex="1">
          <mxGeometry height="20" width="480" x="149" y="240" as="geometry" />
        </mxCell>
        <mxCell id="key" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;fontStyle=1" value="Key: bal(A)" vertex="1">
          <mxGeometry height="60" width="99" x="130" y="100" as="geometry" />
        </mxCell>
        <mxCell id="v1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="TxIdx: 2&lt;br&gt;Val: 100&lt;br&gt;&lt;b&gt;COMMITTED&lt;/b&gt;" vertex="1">
          <mxGeometry height="60" width="90" x="269" y="100" as="geometry" />
        </mxCell>
        <mxCell id="v2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="TxIdx: 5&lt;br&gt;Val: 150&lt;br&gt;&lt;b&gt;COMMITTED&lt;/b&gt;" vertex="1">
          <mxGeometry height="60" width="90" x="399" y="100" as="geometry" />
        </mxCell>
        <mxCell id="v3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="TxIdx: 8&lt;br&gt;Val: 200&lt;br&gt;&lt;b&gt;TENTATIVE&lt;/b&gt;" vertex="1">
          <mxGeometry height="60" width="90" x="529" y="100" as="geometry" />
        </mxCell>
        <mxCell id="v_inv" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;dashed=1;" value="TxIdx: 12&lt;br&gt;&lt;i&gt;(被撤销)&lt;/i&gt;&lt;br&gt;&lt;b&gt;ESTIMATE&lt;/b&gt;" vertex="1">
          <mxGeometry height="50" width="90" x="529" y="190" as="geometry" />
        </mxCell>
        <mxCell id="c1" edge="1" parent="1" source="key" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="v1" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2" edge="1" parent="1" source="v1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="v2" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3" edge="1" parent="1" source="v2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="v3" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c4" edge="1" parent="1" source="v2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="v_inv" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="509" y="130" />
              <mxPoint x="509" y="215" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="N-HM6CXLFrpHx-1zSzAW" name="5.10 排序-执行跨层闭环反馈">
    <mxGraphModel dx="1213" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_510" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" value="图 5.10 排序—执行跨层闭环反馈" vertex="1">
          <mxGeometry height="20" width="400" x="80" y="280" as="geometry" />
        </mxCell>
        <mxCell id="layer_ordering" parent="1" style="swimlane;horizontal=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;startSize=30;" value="&lt;b&gt;第四章：共识与排序层 (MP3-BFT)&lt;/b&gt;" vertex="1">
          <mxGeometry height="90" width="400" x="80" y="40" as="geometry" />
        </mxCell>
        <mxCell id="strategy" parent="layer_ordering" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" value="装载策略 / 桶分配&lt;br&gt;&lt;i&gt;决策: m_max, 域装载比例&lt;/i&gt;" vertex="1">
          <mxGeometry height="40" width="200" x="100" y="40" as="geometry" />
        </mxCell>
        <mxCell id="layer_exec" parent="1" style="swimlane;horizontal=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;startSize=30;" value="&lt;b&gt;第五章：并行执行层 (LEAP++)&lt;/b&gt;" vertex="1">
          <mxGeometry height="90" width="400" x="80" y="170" as="geometry" />
        </mxCell>
        <mxCell id="stats" parent="layer_exec" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;" value="执行统计收集&lt;br&gt;&lt;i&gt;Data: r_abort, r_wait, 热点分布&lt;/i&gt;" vertex="1">
          <mxGeometry height="40" width="200" x="100" y="40" as="geometry" />
        </mxCell>
        <mxCell id="arrow_down" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;width=6;endSize=6.67;" value="下发确定性序列 π_h">
          <mxGeometry height="50" relative="1" width="50" x="-0.0909" as="geometry">
            <mxPoint as="offset" />
            <mxPoint x="140" y="130" as="sourcePoint" />
            <mxPoint x="140" y="170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow_up" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;width=6;endSize=6.67;" value="反馈冲突统计">
          <mxGeometry height="50" relative="1" width="50" x="-0.0909" as="geometry">
            <mxPoint as="offset" />
            <mxPoint x="420" y="170" as="sourcePoint" />
            <mxPoint x="420" y="130" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="loop_text" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#666666;" value="跨层闭环" vertex="1">
          <mxGeometry height="20" width="60" x="250" y="140" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
